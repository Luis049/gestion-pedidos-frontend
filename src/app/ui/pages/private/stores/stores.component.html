<div class="container">
  <div class="container_header">
    <h1>Tiendas</h1>
    <sd-button
      (click)="modalCreateStore()"
      text="Agregar nueva tienda"
      type="primary"
    ></sd-button>
  </div>

  <div class="container_cards">
    @for (store of stores; track store.id) {
    <div class="card">
      <div class="card__header">
        <ng-icon class="card__header__icon" name="lucideStore"></ng-icon>
        <span>{{ store.name }}</span>
      </div>
      <div class="card__body">
        <div class="card__body__item">
          <ng-icon class="icon icon-address" name="lucideMapPin"></ng-icon>
          <span>{{store.address}}</span>
        </div>

        <div class="card__body__item item-bold">
          <ng-icon class="icon icon-user" name="lucideUser"></ng-icon>
          <span>Encargado: {{store.user.username}}</span>
        </div>

        <div class="card__body__item">
          <ng-icon class="icon icon-users" name="lucideUsers"></ng-icon>
          <span>{{store.operatorsCount }} operadores</span>
        </div>

        <div class="card__body__item">
          <ng-icon class="icon icon-printer" name="lucidePrinter"></ng-icon>
          <span>{{store.machinesCount }} m√°quinas</span>
        </div>

        <div class="card__body__item">
          <ng-icon class="icon icon-package" name="lucidePackage"></ng-icon>
          <span>150 pedidos realizados</span>
        </div>
      </div>
      <div class="card__footer">
        <button class="card__footer__btn btn-edit">
          <ng-icon class="icon" name="lucidePencil"></ng-icon>
          <span> Editar </span>
        </button>
        <button class="card__footer__btn btn-delete">
          <ng-icon class="icon" name="lucideTrash"></ng-icon>
          <span> Eliminar </span>
        </button>

        <button class="card__footer__btn btn-add-operator" (click)="modalAddOperator(store.id)">
          <ng-icon class="icon" name="lucideCross" ></ng-icon>
          <span> Operador </span>
        </button>

        <button class="card__footer__btn btn-add-operator" (click)="modalAddMaquina(store.id)">
          <ng-icon class="icon" name="lucideCross" ></ng-icon>
          <span> Maquina </span>
        </button>
      </div>
    </div>
    }
  </div>
</div>

<sd-dialog #dialogCreate title="Crear tienda">
  <app-form-create-store
  #formCreateStore
  (storeCreated)="updateStore()"
  (storeCancel)="dialogCreate.closeDialog()"
  (storeSaved)="dialogCreate.closeDialog(); updateStore()"
  ></app-form-create-store>
</sd-dialog>

<sd-dialog #dialogAddOperator>
  <app-form-create-operator
  [storeId]="storeId"
  (operatorCreated)="dialogAddOperator.closeDialog(); updateStore()"
  ></app-form-create-operator>
</sd-dialog>

<sd-dialog #dialogAddMachine>
  <app-form-create-machine
  [storeId]="storeId"
  (machineCreated)="dialogAddMachine.closeDialog(); updateStore()"
  ></app-form-create-machine>
</sd-dialog>

